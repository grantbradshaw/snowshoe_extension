!function(){function e(e){var a=$(e.target);if(t(a))return!1;if($("#snowshoe-toolbar-wrapper .generalize").length>0&&!a.hasClass("generalize"))return!1;if(a.hasClass("saved"))return!1;var o=n(a);$(o).addClass("general"),a.addClass("selected").addClass("root");var s=$('<button type="button" class="generalize snowshoe">Generalize</button>');$(s).appendTo("#snowshoe-toolbar-wrapper");var r=$('<button type="button" class="save snowshoe">Save</button>');$(r).appendTo("#snowshoe-toolbar-wrapper")}function t(e){var t=e.prop("tagName").toLowerCase();return $.inArray(t,i)>=0||e.hasClass("snowshoe")}function a(e){var t={path:e,elemContents:[]};$(e).each(function(e,a){t.elemContents.push($(a).text())}),c.scrapes.push(t)}function o(e){c.scrapes.forEach(function(t,a){t.path===e&&c.scrapes.splice(a,1)})}function n(e){var t=[];return elemPath=s(e.parents()),$(elemPath).addBack().each(function(){var e=this.tagName.toLowerCase();this.className&&(e+="."+this.className.replace(/ /g,".")),t.push(e)}),t.join(" ")+" "+e.prop("tagName").toLowerCase()}function s(e){return e.not("body").not("html")}function r(e,t){var a=new XMLHttpRequest;return a.open(e,t,!0),a}function l(){var e=window.location.href;return e.split(":")[0]}chrome.runtime.onMessage.addListener(function(t,a,o){if("clicked_browser_action"===t.message){if($("#snowshoe-toolbar-wrapper").length>0)removeToolbar();else{var n=$("<div>").attr("id","snowshoe-toolbar-wrapper");$("body").addClass("snowshoe-active-body").prepend(n),$(document).on("click",e)}var s=$('<button type="button" class="export snowshoe">Export</button>');$(s).appendTo(n)}});var c={url:window.location.href,protocol:l(),track_name:"",scrapes:[]};$(document).on("click",".export",function(){c.track_name=prompt("What is the name of this track?");var e=r("POST","http://localhost:3000/testing");console.log(l()),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(c)),e.onreadystatechange=function(){4==e.readyState&&200==e.status&&(removeToolbar(),c.track_name="",c.scrapes=[])}}),$(document).on("click",".generalize",function(){$(".selected").length>1?($(".selected").removeClass("selected").addClass("general"),$(".root").addClass("selected")):$(".general").removeClass("general").addClass("selected")}),$(document).on("click",".save",function(){var e=$(".selected:first");if($(".selected").length>1)var t=n(e);else var t=e.getPath();a(t),console.log(c),$(".save").remove(),$(".generalize").remove(),$(".selected").removeClass("selected").addClass("saved"),$(".general").removeClass("general"),$(".root").removeClass("root")});const i=["body","div","section","article","header","html","ol","ul"];jQuery.fn.getPath=function(){if(1!=this.length)throw"Requires one element.";for(var e,t=this;t.length;){var a=t[0],o=a.localName;if(!o)break;o=o.toLowerCase();var n=t.parent(),s=n.children(o);s.length>1&&(o+=":eq("+s.index(a)+")"),e=o+(e?">"+e:""),t=n}return e}}();