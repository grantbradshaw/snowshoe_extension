function removeToolbar(){$("#snowshoe-toolbar-wrapper").remove(),$(".selected").removeClass("selected"),$(document).off("click",select_handler),$("body").removeClass("snowshoe-active-body")}function select_handler(e){var t=$(e.target);if(invalidClick(t))return!1;if(t.hasClass("selected"))$(pathToSelected).removeClass("selected"),removeDetails(pathToSelected),console.log(scrapeResults);else{var s=selectSame(t);$(s).addClass("cat"),t.addClass("selected")}}function invalidClick(e){var t=e.prop("tagName").toLowerCase();return $.inArray(t,invalidTargets)>=0||e.hasClass("snowshoe")}function scrapeDetails(e){var t={path:e,elemContents:[]};$(e).each(function(e,s){t.elemContents.push($(s).text())}),scrapeResults.scrapes.push(t)}function removeDetails(e){scrapeResults.scrapes.forEach(function(t,s){t.path===e&&scrapeResults.scrapes.splice(s,1)})}function selectSame(e){var t=[];return elemPath=filterEles(e.parents()),$(elemPath).addBack().each(function(){var e=this.tagName.toLowerCase();this.className&&(e+="."+this.className.replace(/ /g,".")),t.push(e)}),t.join(" ")+" "+e.prop("tagName").toLowerCase()}function filterEles(e){return e.not("body").not("html")}function createCORSRequest(e,t){var s=new XMLHttpRequest;return s.open(e,t,!0),s}function getProtocol(){var e=window.location.href;return e.split(":")[0]}chrome.runtime.onMessage.addListener(function(e,t,s){if("clicked_browser_action"===e.message){if($("#snowshoe-toolbar-wrapper").length>0)removeToolbar();else{var a=$("<div>").attr("id","snowshoe-toolbar-wrapper");$("body").addClass("snowshoe-active-body").prepend(a),$(document).on("click",select_handler)}var o=$('<button type="button" class="export snowshoe">Export</button>');$(o).appendTo(a)}});var scrapeResults={url:window.location.href,protocol:getProtocol(),track_name:"",scrapes:[]};$(document).on("click",".export",function(){scrapeResults.track_name=prompt("What is the name of this track?");var e=createCORSRequest("POST","http://localhost:3000/testing");console.log(getProtocol()),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify(scrapeResults)),e.onreadystatechange=function(){4==e.readyState&&200==e.status&&(removeToolbar(),scrapeResults.track_name="",scrapeResults.scrapes=[])}});const invalidTargets=["body","div","section","article","header","html","ol","ul"];jQuery.fn.getPath=function(){if(1!=this.length)throw"Requires one element.";for(var e,t=this;t.length;){var s=t[0],a=s.localName;if(!a)break;a=a.toLowerCase();var o=t.parent(),r=o.children(a);r.length>1&&(a+=":eq("+r.index(s)+")"),e=a+(e?">"+e:""),t=o}return e};